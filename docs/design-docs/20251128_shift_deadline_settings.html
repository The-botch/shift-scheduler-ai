<!DOCTYPE html>
<html lang="ja">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>ã‚·ãƒ•ãƒˆå¸Œæœ›å…¥åŠ›æœŸé™è¨­å®šæ©Ÿèƒ½ - è¨­è¨ˆæ›¸ v2.0.0</title>
    <style>
        body {
            font-family: 'Segoe UI', Meiryo, sans-serif;
            line-height: 1.6;
            max-width: 1200px;
            margin: 0 auto;
            padding: 20px;
            background-color: #f5f5f5;
        }
        h1 {
            color: #2c3e50;
            border-bottom: 3px solid #3498db;
            padding-bottom: 10px;
        }
        h2 {
            color: #34495e;
            border-left: 5px solid #3498db;
            padding-left: 10px;
            margin-top: 30px;
        }
        h3 {
            color: #546e7a;
            border-bottom: 1px solid #b0bec5;
            padding-bottom: 5px;
        }
        table {
            width: 100%;
            border-collapse: collapse;
            margin: 20px 0;
            background-color: white;
            box-shadow: 0 2px 4px rgba(0,0,0,0.1);
        }
        th {
            background-color: #3498db;
            color: white;
            padding: 12px;
            text-align: left;
        }
        td {
            padding: 10px;
            border: 1px solid #ddd;
        }
        tr:nth-child(even) {
            background-color: #f9f9f9;
        }
        .code-block {
            background-color: #2d2d2d;
            color: #f8f8f2;
            padding: 15px;
            border-radius: 5px;
            overflow-x: auto;
            margin: 15px 0;
            font-family: 'Consolas', 'Monaco', monospace;
            font-size: 14px;
        }
        .warning {
            background-color: #fff3cd;
            border-left: 4px solid #ffc107;
            padding: 15px;
            margin: 15px 0;
        }
        .info {
            background-color: #d1ecf1;
            border-left: 4px solid #17a2b8;
            padding: 15px;
            margin: 15px 0;
        }
        .success {
            background-color: #d4edda;
            border-left: 4px solid #28a745;
            padding: 15px;
            margin: 15px 0;
        }
        .metadata {
            background-color: #f8f9fa;
            padding: 15px;
            border-radius: 5px;
            margin-bottom: 20px;
        }
        .change-badge {
            display: inline-block;
            padding: 3px 8px;
            border-radius: 3px;
            font-size: 12px;
            font-weight: bold;
            margin-left: 8px;
        }
        .added {
            background-color: #d4edda;
            color: #155724;
        }
        .removed {
            background-color: #f8d7da;
            color: #721c24;
        }
        .modified {
            background-color: #fff3cd;
            color: #856404;
        }
    </style>
</head>
<body>

<div class="metadata">
    <h1>ã‚·ãƒ•ãƒˆå¸Œæœ›å…¥åŠ›æœŸé™è¨­å®šæ©Ÿèƒ½ - è¨­è¨ˆæ›¸</h1>
    <p><strong>ãƒãƒ¼ã‚¸ãƒ§ãƒ³:</strong> 2.0.0</p>
    <p><strong>ä½œæˆæ—¥:</strong> 2025-01-27</p>
    <p><strong>æœ€çµ‚æ›´æ–°:</strong> 2025-11-28</p>
    <p><strong>å¯¾è±¡ã‚·ã‚¹ãƒ†ãƒ :</strong> shift-scheduler-ai</p>
    <p><strong>é–¢é€£Issue:</strong> #155 ç· åˆ‡æ—¥è¨­å®šã®ä»•æ§˜æ•´ç†ã¨å®Ÿè£…</p>
    <p><strong>é–¢é€£PR:</strong></p>
    <ul>
        <li>Backend: <a href="https://github.com/The-botch/shift-scheduler-ai/pull/157" target="_blank">#157</a> (feature/shift-deadline-settings)</li>
        <li>LIFF: <a href="https://github.com/The-botch/shift-scheduler-ai-liff/pull/12" target="_blank">#12</a> (employment_typeåŸºæº–ã«å¤‰æ›´ - MERGED)</li>
        <li>LIFF: <a href="https://github.com/The-botch/shift-scheduler-ai-liff/pull/13" target="_blank">#13</a> (start_dayå‰Šé™¤ã¨ã‚¨ãƒ³ãƒ‰ãƒã‚¤ãƒ³ãƒˆä¿®æ­£)</li>
    </ul>
</div>

<h2>ğŸ“‹ ç›®æ¬¡</h2>
<ol>
    <li><a href="#changelog">å¤‰æ›´å±¥æ­´ï¼ˆv2.0.0ï¼‰</a></li>
    <li><a href="#overview">æ¦‚è¦</a></li>
    <li><a href="#table-design">ãƒ†ãƒ¼ãƒ–ãƒ«è¨­è¨ˆ</a></li>
    <li><a href="#impact-analysis">å½±éŸ¿ç¯„å›²åˆ†æ</a></li>
    <li><a href="#test-results">ãƒ†ã‚¹ãƒˆçµæœ</a></li>
</ol>

<h2 id="changelog">1. å¤‰æ›´å±¥æ­´ï¼ˆv2.0.0ï¼‰</h2>

<div class="success">
<h3>v2.0.0 ã®ä¸»è¦å¤‰æ›´ç‚¹</h3>
<table>
    <tr>
        <th>å¤‰æ›´é …ç›®</th>
        <th>å¤‰æ›´å‰ï¼ˆv1.0.0ï¼‰</th>
        <th>å¤‰æ›´å¾Œï¼ˆv2.0.0ï¼‰</th>
        <th>ç†ç”±</th>
    </tr>
    <tr>
        <td><strong>åŸºæº–ã‚«ãƒ©ãƒ </strong></td>
        <td>payment_type<br>('HOURLY', 'MONTHLY')</td>
        <td>employment_type<br>('FULL_TIME', 'PART_TIME')</td>
        <td>å¥‘ç´„å½¢æ…‹ï¼ˆemployment_typeï¼‰ã«ã‚ˆã‚‹æœŸé™ç®¡ç†ã®æ–¹ãŒç›´æ„Ÿçš„ã§ãƒ“ã‚¸ãƒã‚¹ãƒ­ã‚¸ãƒƒã‚¯ã«é©åˆ</td>
    </tr>
    <tr>
        <td><strong>start_day</strong></td>
        <td>å­˜åœ¨ï¼ˆNULLå¯ï¼‰</td>
        <td><span class="removed">å‰Šé™¤</span></td>
        <td>ç¬¬1æ¡ˆä½œæˆå®Œäº†æ™‚ãŒå…¥åŠ›é–‹å§‹ã®æ˜ç¢ºãªåŸºæº–ã¨ãªã‚‹ãŸã‚ä¸è¦</td>
    </tr>
    <tr>
        <td><strong>CHECKåˆ¶ç´„</strong></td>
        <td>ãªã—</td>
        <td><span class="added">è¿½åŠ </span><br>â€¢ deadline_day: 1-31<br>â€¢ deadline_hour: 0-23<br>â€¢ deadline_minute: 0-59</td>
        <td>ãƒ‡ãƒ¼ã‚¿ã®æ•´åˆæ€§ã‚’DBå±¤ã§ä¿è¨¼</td>
    </tr>
    <tr>
        <td><strong>FKåˆ¶ç´„</strong></td>
        <td>ãªã—</td>
        <td><span class="added">è¿½åŠ </span><br>tenant_id â†’ core.tenants</td>
        <td>å‚ç…§æ•´åˆæ€§ã®ä¿è¨¼</td>
    </tr>
    <tr>
        <td><strong>UNIQUEåˆ¶ç´„</strong></td>
        <td>(tenant_id, payment_type)</td>
        <td>(tenant_id, employment_type)</td>
        <td>ã‚«ãƒ©ãƒ åå¤‰æ›´ã«ä¼´ã†æ›´æ–°</td>
    </tr>
    <tr>
        <td><strong>COMMENT</strong></td>
        <td>ãªã—</td>
        <td><span class="added">è¿½åŠ </span></td>
        <td>ãƒ†ãƒ¼ãƒ–ãƒ«ãƒ»ã‚«ãƒ©ãƒ ã®ä»•æ§˜ã‚’æ˜ç¢ºåŒ–</td>
    </tr>
</table>
</div>

<h2 id="overview">2. æ¦‚è¦</h2>

<h3>2.1 èƒŒæ™¯ã¨ç›®çš„</h3>
<p>ã‚·ãƒ•ãƒˆå¸Œæœ›å…¥åŠ›ã®ç· åˆ‡æ—¥ã‚’ãƒ‡ãƒ¼ã‚¿ãƒ™ãƒ¼ã‚¹ã§ç®¡ç†ã—ã€å¥‘ç´„å½¢æ…‹ï¼ˆæ­£ç¤¾å“¡/ã‚¢ãƒ«ãƒã‚¤ãƒˆãƒ»ãƒ‘ãƒ¼ãƒˆï¼‰ã”ã¨ã«ç•°ãªã‚‹æœŸé™ã‚’è¨­å®šå¯èƒ½ã«ã™ã‚‹ã€‚</p>

<div class="info">
<strong>è§£æ±ºã™ã‚‹èª²é¡Œ:</strong>
<ul>
    <li>å¥‘ç´„å½¢æ…‹åˆ¥ã®æœŸé™ç®¡ç†ãŒã§ããªã„ â†’ employment_typeåŸºæº–ã§ç®¡ç†</li>
    <li>æœŸé™ãŒãƒ•ãƒ­ãƒ³ãƒˆã‚¨ãƒ³ãƒ‰ã«ãƒãƒ¼ãƒ‰ã‚³ãƒ¼ãƒ‰ã•ã‚Œã¦ã„ã‚‹ â†’ DBã‹ã‚‰å‹•çš„å–å¾—</li>
    <li>å…¥åŠ›é–‹å§‹æ—¥ã®æ‰±ã„ãŒæ›–æ˜§ â†’ ç¬¬1æ¡ˆä½œæˆå®Œäº†æ™‚ã‚’æ˜ç¢ºãªé–‹å§‹åŸºæº–ã¨ã™ã‚‹</li>
</ul>
</div>

<h3>2.2 å…¥åŠ›æœŸé–“ã®å®šç¾©</h3>
<table>
    <tr>
        <th>é …ç›®</th>
        <th>å†…å®¹</th>
    </tr>
    <tr>
        <td><strong>å…¥åŠ›é–‹å§‹</strong></td>
        <td>ç¬¬1æ¡ˆä½œæˆå®Œäº†æ™‚ï¼ˆops.shift_plans.status='FIRST_DRAFT_COMPLETED'ï¼‰</td>
    </tr>
    <tr>
        <td><strong>å…¥åŠ›ç· åˆ‡</strong></td>
        <td>N-1æœˆã® deadline_day æ—¥ deadline_hour:deadline_minute</td>
    </tr>
    <tr>
        <td><strong>å¯¾è±¡æœˆ</strong></td>
        <td>Næœˆï¼ˆä¾‹: 2025å¹´2æœˆåˆ†ã®ã‚·ãƒ•ãƒˆå¸Œæœ›ã‚’1æœˆä¸­ã«å…¥åŠ›ï¼‰</td>
    </tr>
</table>

<div class="success">
<strong>ä¾‹: 2025å¹´2æœˆåˆ†ã®ã‚·ãƒ•ãƒˆå¸Œæœ›ï¼ˆã‚¢ãƒ«ãƒã‚¤ãƒˆãƒ»ãƒ‘ãƒ¼ãƒˆï¼‰</strong>
<ul>
    <li><strong>å…¥åŠ›é–‹å§‹:</strong> ç¬¬1æ¡ˆä½œæˆå®Œäº†æ™‚ï¼ˆã‚·ã‚¹ãƒ†ãƒ ãŒæ±ºå®šï¼‰</li>
    <li><strong>å…¥åŠ›ç· åˆ‡:</strong> 2025å¹´1æœˆ15æ—¥ 23:59:59</li>
    <li><strong>è¨­å®šå€¤:</strong> employment_type='PART_TIME', deadline_day=15, deadline_hour=23, deadline_minute=59</li>
</ul>
</div>

<h2 id="table-design">3. ãƒ†ãƒ¼ãƒ–ãƒ«è¨­è¨ˆ</h2>

<h3>3.1 DDLï¼ˆæœ€çµ‚ç‰ˆï¼‰</h3>

<div class="code-block">
<pre>
-- core.shift_deadline_settingsï¼ˆã‚·ãƒ•ãƒˆå¸Œæœ›å…¥åŠ›ç· åˆ‡è¨­å®šï¼‰
-- å…¥åŠ›é–‹å§‹: ç¬¬1æ¡ˆä½œæˆå®Œäº†æ™‚ã€ç· åˆ‡: N-1æœˆã®deadline_day deadline_hour:deadline_minute
CREATE TABLE IF NOT EXISTS core.shift_deadline_settings (
    deadline_setting_id SERIAL PRIMARY KEY,
    tenant_id INTEGER NOT NULL,
    employment_type VARCHAR(50) NOT NULL, -- 'FULL_TIME', 'PART_TIME'
    deadline_day INTEGER NOT NULL CHECK (deadline_day BETWEEN 1 AND 31),
    deadline_hour INTEGER NOT NULL DEFAULT 23 CHECK (deadline_hour BETWEEN 0-23),
    deadline_minute INTEGER NOT NULL DEFAULT 59 CHECK (deadline_minute BETWEEN 0 AND 59),
    is_enabled BOOLEAN NOT NULL DEFAULT true,
    description TEXT,
    created_at TIMESTAMP NOT NULL DEFAULT CURRENT_TIMESTAMP,
    updated_at TIMESTAMP NOT NULL DEFAULT CURRENT_TIMESTAMP,
    CONSTRAINT uq_shift_deadline_settings_tenant_employment
        UNIQUE(tenant_id, employment_type),
    CONSTRAINT fk_shift_deadline_settings_tenant
        FOREIGN KEY (tenant_id) REFERENCES core.tenants(tenant_id) ON DELETE CASCADE
);

COMMENT ON TABLE core.shift_deadline_settings IS 'ã‚·ãƒ•ãƒˆå¸Œæœ›å…¥åŠ›ç· åˆ‡è¨­å®šï¼ˆå¥‘ç´„å½¢æ…‹åˆ¥ï¼‰ã€‚å…¥åŠ›é–‹å§‹ã¯ç¬¬1æ¡ˆä½œæˆå®Œäº†æ™‚';
COMMENT ON COLUMN core.shift_deadline_settings.employment_type IS 'å¥‘ç´„å½¢æ…‹ï¼ˆFULL_TIME=æ­£ç¤¾å“¡ã€PART_TIME=ã‚¢ãƒ«ãƒã‚¤ãƒˆãƒ»ãƒ‘ãƒ¼ãƒˆï¼‰';
COMMENT ON COLUMN core.shift_deadline_settings.deadline_day IS 'ã‚·ãƒ•ãƒˆå¸Œæœ›å…¥åŠ›ç· åˆ‡æ—¥ï¼ˆN-1æœˆã®1-31æ—¥ï¼‰';
COMMENT ON COLUMN core.shift_deadline_settings.deadline_hour IS 'ç· åˆ‡æ™‚åˆ»ï¼ˆæ™‚ï¼‰0-23';
COMMENT ON COLUMN core.shift_deadline_settings.deadline_minute IS 'ç· åˆ‡æ™‚åˆ»ï¼ˆåˆ†ï¼‰0-59';
COMMENT ON COLUMN core.shift_deadline_settings.is_enabled IS 'æœŸé™ãƒã‚§ãƒƒã‚¯æœ‰åŠ¹/ç„¡åŠ¹ãƒ•ãƒ©ã‚°';
COMMENT ON COLUMN core.shift_deadline_settings.description IS 'å‚™è€ƒï¼ˆé‹ç”¨ãƒ¡ãƒ¢ãªã©ï¼‰';

-- ã‚¤ãƒ³ãƒ‡ãƒƒã‚¯ã‚¹
CREATE INDEX idx_shift_deadline_settings_tenant
    ON core.shift_deadline_settings(tenant_id);

-- æ›´æ–°æ—¥æ™‚è‡ªå‹•æ›´æ–°ãƒˆãƒªã‚¬ãƒ¼
CREATE TRIGGER trg_shift_deadline_settings_updated_at
    BEFORE UPDATE ON core.shift_deadline_settings
    FOR EACH ROW
    EXECUTE FUNCTION update_updated_at_column();
</pre>
</div>

<h3>3.2 DMLï¼ˆåˆæœŸãƒ‡ãƒ¼ã‚¿ï¼‰</h3>

<div class="code-block">
<pre>
-- æ­£ç¤¾å“¡ï¼ˆFULL_TIMEï¼‰ã®æœŸé™è¨­å®š
-- å…¥åŠ›é–‹å§‹: ç¬¬1æ¡ˆä½œæˆå®Œäº†æ™‚ã€ç· åˆ‡: N-1æœˆ10æ—¥23:59
INSERT INTO core.shift_deadline_settings
  (tenant_id, employment_type, deadline_day, deadline_hour, deadline_minute, is_enabled, description)
VALUES
  (3, 'FULL_TIME', 10, 23, 59, true, 'æ­£ç¤¾å“¡ã®ã‚·ãƒ•ãƒˆå¸Œæœ›ç· åˆ‡ï¼ˆç¬¬1æ¡ˆä½œæˆå®Œäº†ï½N-1æœˆ10æ—¥23:59ï¼‰')
ON CONFLICT (tenant_id, employment_type) DO UPDATE
SET
    deadline_day = EXCLUDED.deadline_day,
    deadline_hour = EXCLUDED.deadline_hour,
    deadline_minute = EXCLUDED.deadline_minute,
    is_enabled = EXCLUDED.is_enabled,
    description = EXCLUDED.description,
    updated_at = CURRENT_TIMESTAMP;

-- ã‚¢ãƒ«ãƒã‚¤ãƒˆãƒ»ãƒ‘ãƒ¼ãƒˆï¼ˆPART_TIMEï¼‰ã®æœŸé™è¨­å®š
-- å…¥åŠ›é–‹å§‹: ç¬¬1æ¡ˆä½œæˆå®Œäº†æ™‚ã€ç· åˆ‡: N-1æœˆ15æ—¥23:59
INSERT INTO core.shift_deadline_settings
  (tenant_id, employment_type, deadline_day, deadline_hour, deadline_minute, is_enabled, description)
VALUES
  (3, 'PART_TIME', 15, 23, 59, true, 'ã‚¢ãƒ«ãƒã‚¤ãƒˆãƒ»ãƒ‘ãƒ¼ãƒˆã®ã‚·ãƒ•ãƒˆå¸Œæœ›ç· åˆ‡ï¼ˆç¬¬1æ¡ˆä½œæˆå®Œäº†ï½N-1æœˆ15æ—¥23:59ï¼‰')
ON CONFLICT (tenant_id, employment_type) DO UPDATE
SET
    deadline_day = EXCLUDED.deadline_day,
    deadline_hour = EXCLUDED.deadline_hour,
    deadline_minute = EXCLUDED.deadline_minute,
    is_enabled = EXCLUDED.is_enabled,
    description = EXCLUDED.description,
    updated_at = CURRENT_TIMESTAMP;
</pre>
</div>

<h3>3.3 ã‚«ãƒ©ãƒ å®šç¾©</h3>

<table>
    <tr>
        <th>ã‚«ãƒ©ãƒ å</th>
        <th>å‹</th>
        <th>NULL</th>
        <th>åˆ¶ç´„</th>
        <th>èª¬æ˜</th>
    </tr>
    <tr>
        <td>deadline_setting_id</td>
        <td>SERIAL</td>
        <td>NOT NULL</td>
        <td>PRIMARY KEY</td>
        <td>ä¸»ã‚­ãƒ¼</td>
    </tr>
    <tr>
        <td>tenant_id</td>
        <td>INTEGER</td>
        <td>NOT NULL</td>
        <td>FK â†’ core.tenants</td>
        <td>ãƒ†ãƒŠãƒ³ãƒˆID</td>
    </tr>
    <tr>
        <td>employment_type <span class="modified">å¤‰æ›´</span></td>
        <td>VARCHAR(50)</td>
        <td>NOT NULL</td>
        <td>UNIQUE (tenant_id, employment_type)</td>
        <td>å¥‘ç´„å½¢æ…‹<br>'FULL_TIME' (æ­£ç¤¾å“¡)<br>'PART_TIME' (ã‚¢ãƒ«ãƒã‚¤ãƒˆãƒ»ãƒ‘ãƒ¼ãƒˆ)</td>
    </tr>
    <tr>
        <td>deadline_day</td>
        <td>INTEGER</td>
        <td>NOT NULL</td>
        <td>CHECK (1-31) <span class="added">è¿½åŠ </span></td>
        <td>ç· åˆ‡æ—¥ï¼ˆN-1æœˆã®ä½•æ—¥ã¾ã§ï¼‰</td>
    </tr>
    <tr>
        <td>deadline_hour</td>
        <td>INTEGER</td>
        <td>NOT NULL</td>
        <td>DEFAULT 23<br>CHECK (0-23) <span class="added">è¿½åŠ </span></td>
        <td>ç· åˆ‡æ™‚åˆ»ï¼ˆæ™‚ï¼‰</td>
    </tr>
    <tr>
        <td>deadline_minute</td>
        <td>INTEGER</td>
        <td>NOT NULL</td>
        <td>DEFAULT 59<br>CHECK (0-59) <span class="added">è¿½åŠ </span></td>
        <td>ç· åˆ‡æ™‚åˆ»ï¼ˆåˆ†ï¼‰</td>
    </tr>
    <tr>
        <td>is_enabled</td>
        <td>BOOLEAN</td>
        <td>NOT NULL</td>
        <td>DEFAULT true</td>
        <td>æœŸé™ãƒã‚§ãƒƒã‚¯æœ‰åŠ¹/ç„¡åŠ¹<br>false = æœŸé™ãƒã‚§ãƒƒã‚¯ã‚¹ã‚­ãƒƒãƒ—</td>
    </tr>
    <tr>
        <td>description</td>
        <td>TEXT</td>
        <td>NULLå¯</td>
        <td>-</td>
        <td>å‚™è€ƒï¼ˆé‹ç”¨ãƒ¡ãƒ¢ï¼‰</td>
    </tr>
    <tr>
        <td>created_at</td>
        <td>TIMESTAMP</td>
        <td>NOT NULL</td>
        <td>DEFAULT CURRENT_TIMESTAMP</td>
        <td>ä½œæˆæ—¥æ™‚</td>
    </tr>
    <tr>
        <td>updated_at</td>
        <td>TIMESTAMP</td>
        <td>NOT NULL</td>
        <td>DEFAULT CURRENT_TIMESTAMP<br>è‡ªå‹•æ›´æ–°ãƒˆãƒªã‚¬ãƒ¼</td>
        <td>æ›´æ–°æ—¥æ™‚</td>
    </tr>
</table>

<h2 id="impact-analysis">4. å½±éŸ¿ç¯„å›²åˆ†æ</h2>

<h3>4.1 æ—¢å­˜ã‚·ã‚¹ãƒ†ãƒ ã¸ã®å½±éŸ¿</h3>

<div class="success">
<strong>âœ… æ—¢å­˜ã‚·ã‚¹ãƒ†ãƒ ã¸ã®å½±éŸ¿ãªã—</strong>
<ul>
    <li><strong>æ—¢å­˜ã®ãƒ•ãƒ­ãƒ³ãƒˆã‚¨ãƒ³ãƒ‰ï¼ˆReactï¼‰:</strong> å½±éŸ¿ãªã—ï¼ˆæ–°è¦ãƒ†ãƒ¼ãƒ–ãƒ«ã¨æ–°è¦ã‚¨ãƒ³ãƒ‰ãƒã‚¤ãƒ³ãƒˆã®ã¿ï¼‰</li>
    <li><strong>æ—¢å­˜ã®ãƒãƒƒã‚¯ã‚¨ãƒ³ãƒ‰API:</strong> å½±éŸ¿ãªã—ï¼ˆå®Œå…¨ã«ç‹¬ç«‹ã—ãŸæ–°è¦ã‚¨ãƒ³ãƒ‰ãƒã‚¤ãƒ³ãƒˆ /api/liff/deadline-settings ã®ã¿è¿½åŠ ï¼‰</li>
    <li><strong>æ—¢å­˜ã®ãƒ‡ãƒ¼ã‚¿ãƒ™ãƒ¼ã‚¹:</strong> å½±éŸ¿ãªã—ï¼ˆæ–°è¦ãƒ†ãƒ¼ãƒ–ãƒ«è¿½åŠ ã®ã¿ã€æ—¢å­˜ãƒ†ãƒ¼ãƒ–ãƒ«ã¯ç„¡å¤‰æ›´ï¼‰</li>
</ul>
</div>

<h3>4.2 æ–°è¦ã‚¨ãƒ³ãƒ‰ãƒã‚¤ãƒ³ãƒˆ</h3>

<div class="info">
<strong>âœ… backend/src/routes/liff.js ã«è¿½åŠ æ¸ˆã¿</strong>
<p>GET /api/liff/deadline-settings - ã‚·ãƒ•ãƒˆå¸Œæœ›å…¥åŠ›æœŸé™è¨­å®šã‚’å–å¾—</p>
</div>

<table>
    <tr>
        <th>ã‚¨ãƒ³ãƒ‰ãƒã‚¤ãƒ³ãƒˆ</th>
        <th>ãƒ¡ã‚½ãƒƒãƒ‰</th>
        <th>ãƒ‘ãƒ©ãƒ¡ãƒ¼ã‚¿</th>
        <th>ãƒ¬ã‚¹ãƒãƒ³ã‚¹</th>
    </tr>
    <tr>
        <td>/api/liff/deadline-settings</td>
        <td>GET</td>
        <td>tenant_id (required)</td>
        <td>{ success: true, data: [{ employment_type, deadline_day, deadline_hour, deadline_minute, is_enabled, description }] }</td>
    </tr>
</table>

<h3>4.3 å°†æ¥å®Ÿè£…äºˆå®šã®ãƒãƒƒã‚¯ã‚¨ãƒ³ãƒ‰API</h3>

<div class="info">
<strong>â„¹ï¸ å°†æ¥å®Ÿè£…äºˆå®š: ãƒã‚¹ã‚¿ãƒ¼ç®¡ç†API</strong>
<p>ãƒ¦ãƒ¼ã‚¶ãƒ¼å´ã‹ã‚‰æœŸé™è¨­å®šã‚’ç¢ºèªãƒ»å¤‰æ›´ã§ãã‚‹ã‚ˆã†ã«ã™ã‚‹éš›ã«å®Ÿè£…äºˆå®šã§ã™ã€‚</p>
</div>

<table>
    <tr>
        <th>ãƒ•ã‚¡ã‚¤ãƒ«ãƒ‘ã‚¹</th>
        <th>ã‚¨ãƒ³ãƒ‰ãƒã‚¤ãƒ³ãƒˆ</th>
        <th>å¿…è¦ãªä¿®æ­£</th>
        <th>å„ªå…ˆåº¦</th>
        <th>ç›®çš„</th>
    </tr>
    <tr>
        <td>backend/src/routes/master.js</td>
        <td>GET/POST/PUT/DELETE<br>/api/master/shift-deadline-settings</td>
        <td><span class="added">æ–°è¦è¿½åŠ </span><br>æœŸé™è¨­å®šã®CRUD API<br>â€¢ GET: å…¨æœŸé™è¨­å®šå–å¾—<br>â€¢ POST: æ–°è¦æœŸé™è¨­å®šä½œæˆ<br>â€¢ PUT: æ—¢å­˜æœŸé™è¨­å®šæ›´æ–°<br>â€¢ DELETE: æœŸé™è¨­å®šå‰Šé™¤</td>
        <td>ğŸŸ¢ ä½</td>
        <td>ç®¡ç†ç”»é¢ã‹ã‚‰ã®æœŸé™è¨­å®šå¤‰æ›´ã‚’å¯èƒ½ã«ã™ã‚‹<br>ï¼ˆç¾åœ¨ã¯DMLã§ç›´æ¥ãƒ‡ãƒ¼ã‚¿ãƒ™ãƒ¼ã‚¹æ“ä½œï¼‰</td>
    </tr>
</table>

<div class="warning">
<strong>ğŸ“Œ Backendå´ã®æœŸé™ãƒã‚§ãƒƒã‚¯ãƒ­ã‚¸ãƒƒã‚¯ã«ã¤ã„ã¦</strong>
<p><strong>ç¾åœ¨ã¯å®Ÿè£…ä¸è¦</strong>ã¨åˆ¤æ–­ã—ã¦ã„ã¾ã™ã€‚ç†ç”±ã¯ä»¥ä¸‹ã®é€šã‚Šã§ã™:</p>
<ul>
    <li>LIFFç‰ˆã§æœŸé™ãƒã‚§ãƒƒã‚¯ã‚’å®Ÿè£…æ¸ˆã¿ï¼ˆæœŸé™è¶…éæ™‚ã¯å…¥åŠ›UIç„¡åŠ¹åŒ–ï¼‰</li>
    <li>ãƒ¦ãƒ¼ã‚¶ãƒ¼ã¯æœŸé™å¾Œã«ãã‚‚ãã‚‚å…¥åŠ›ã§ããªã„ä»•çµ„ã¿</li>
    <li>ã‚»ã‚­ãƒ¥ãƒªãƒ†ã‚£è¦ä»¶ãŒå¤‰æ›´ã•ã‚ŒãŸå ´åˆã¯ã€DeadlineValidationServiceã‚’å®Ÿè£…ã—ã¦å„ã‚¨ãƒ³ãƒ‰ãƒã‚¤ãƒ³ãƒˆã§ãƒã‚§ãƒƒã‚¯ã‚’è¿½åŠ </li>
</ul>
</div>

<h3>4.4 LIFFå´ã®å®Ÿè£…çŠ¶æ³</h3>

<div class="success">
<strong>âœ… LIFFå´ã®å®Ÿè£…å®Œäº†</strong>
<p>shift-scheduler-ai-liff ãƒªãƒã‚¸ãƒˆãƒªã§ã®å®Ÿè£…ãŒå®Œäº†ã—ã¦ã„ã¾ã™ã€‚</p>
</div>

<table>
    <tr>
        <th>ãƒ•ã‚¡ã‚¤ãƒ«ãƒ‘ã‚¹</th>
        <th>å½¹å‰²</th>
        <th>å®Ÿè£…å†…å®¹</th>
        <th>çŠ¶æ…‹</th>
    </tr>
    <tr>
        <td>shift-scheduler-ai-liff/<br>index.html</td>
        <td>LINE LIFF<br>ã‚·ãƒ•ãƒˆå¸Œæœ›å…¥åŠ›ç”»é¢</td>
        <td>
            <strong>PR #12 (MERGED):</strong><br>
            â€¢ payment_type â†’ employment_type ã«å¤‰æ›´<br>
            <br>
            <strong>PR #13 (OPEN):</strong><br>
            â€¢ start_day ãƒ•ã‚£ãƒ¼ãƒ«ãƒ‰å‰Šé™¤<br>
            â€¢ /api/liff/deadline-settings ã‚¨ãƒ³ãƒ‰ãƒã‚¤ãƒ³ãƒˆã«ä¿®æ­£<br>
            <br>
            <strong>å®Ÿè£…æ¸ˆã¿æ©Ÿèƒ½:</strong><br>
            â€¢ APIã‹ã‚‰æœŸé™æƒ…å ±ã‚’å‹•çš„å–å¾—<br>
            â€¢ æœŸé™è¶…éæ™‚ã®å…¥åŠ›ç¦æ­¢UI<br>
            â€¢ å¥‘ç´„å½¢æ…‹åˆ¥ã®æœŸé™è¡¨ç¤º
        </td>
        <td><span class="success">âœ… å®Œäº†</span></td>
    </tr>
</table>

<div class="info">
<strong>ğŸ“Œ Reactç‰ˆãƒ•ãƒ­ãƒ³ãƒˆã‚¨ãƒ³ãƒ‰ã«ã¤ã„ã¦</strong>
<p>ç¾åœ¨ã®é‹ç”¨ã§ã¯<strong>LIFFç‰ˆã®ã¿</strong>ã‚’ä½¿ç”¨ã—ã¦ã„ã¾ã™ã€‚Reactç‰ˆï¼ˆfrontend/src/components/screens/shift/LineShiftInput.jsxç­‰ï¼‰ã¸ã®å¯¾å¿œã¯ã€å°†æ¥çš„ã«Reactç‰ˆã‚’ä½¿ç”¨ã™ã‚‹å ´åˆã«å®Ÿæ–½ã—ã¾ã™ã€‚</p>
</div>

<h3>4.5 ãƒ‡ãƒ¼ã‚¿ãƒ•ãƒ­ãƒ¼å›³</h3>

<div class="code-block">
<pre>
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ ãƒ•ãƒ­ãƒ³ãƒˆã‚¨ãƒ³ãƒ‰ (LIFF / React)                                    â”‚
â”‚                                                                 â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”      â”‚
â”‚  â”‚ 1. ãƒ¦ãƒ¼ã‚¶ãƒ¼ãŒã‚·ãƒ•ãƒˆå¸Œæœ›å…¥åŠ›ç”»é¢ã‚’é–‹ã                   â”‚      â”‚
â”‚  â”‚    - staff_id ã‹ã‚‰ employment_type ã‚’åˆ¤å®š             â”‚      â”‚
â”‚  â”‚    - FULL_TIME ã¾ãŸã¯ PART_TIME                       â”‚      â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜      â”‚
â”‚                   â”‚                                             â”‚
â”‚                   â–¼                                             â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”      â”‚
â”‚  â”‚ 2. APIãƒªã‚¯ã‚¨ã‚¹ãƒˆ                                       â”‚      â”‚
â”‚  â”‚    GET /api/liff/deadline-settings                    â”‚      â”‚
â”‚  â”‚    ?tenant_id=3                                       â”‚      â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜      â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                    â”‚
                    â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ ãƒãƒƒã‚¯ã‚¨ãƒ³ãƒ‰ (DeadlineValidationService)                          â”‚
â”‚                                                                   â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”        â”‚
â”‚  â”‚ 3. core.shift_deadline_settings ã‹ã‚‰æœŸé™ã‚’å–å¾—        â”‚        â”‚
â”‚  â”‚    SELECT * FROM core.shift_deadline_settings         â”‚        â”‚
â”‚  â”‚    WHERE tenant_id = 3                                â”‚        â”‚
â”‚  â”‚    ORDER BY employment_type                           â”‚        â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜        â”‚
â”‚                   â”‚                                               â”‚
â”‚                   â–¼                                               â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”        â”‚
â”‚  â”‚ 4. ãƒ¬ã‚¹ãƒãƒ³ã‚¹è¿”å´ï¼ˆå…¨å¥‘ç´„å½¢æ…‹ã®æœŸé™è¨­å®šï¼‰              â”‚        â”‚
â”‚  â”‚    {                                                  â”‚        â”‚
â”‚  â”‚      "success": true,                                 â”‚        â”‚
â”‚  â”‚      "data": [                                        â”‚        â”‚
â”‚  â”‚        {                                              â”‚        â”‚
â”‚  â”‚          "employment_type": "FULL_TIME",              â”‚        â”‚
â”‚  â”‚          "deadline_day": 10,                          â”‚        â”‚
â”‚  â”‚          "deadline_hour": 23,                         â”‚        â”‚
â”‚  â”‚          "deadline_minute": 59,                       â”‚        â”‚
â”‚  â”‚          "is_enabled": true,                          â”‚        â”‚
â”‚  â”‚          "description": "æ­£ç¤¾å“¡..."                   â”‚        â”‚
â”‚  â”‚        },                                             â”‚        â”‚
â”‚  â”‚        {                                              â”‚        â”‚
â”‚  â”‚          "employment_type": "PART_TIME",              â”‚        â”‚
â”‚  â”‚          "deadline_day": 15,                          â”‚        â”‚
â”‚  â”‚          "deadline_hour": 23,                         â”‚        â”‚
â”‚  â”‚          "deadline_minute": 59,                       â”‚        â”‚
â”‚  â”‚          "is_enabled": true,                          â”‚        â”‚
â”‚  â”‚          "description": "ã‚¢ãƒ«ãƒã‚¤ãƒˆãƒ»ãƒ‘ãƒ¼ãƒˆ..."        â”‚        â”‚
â”‚  â”‚        }                                              â”‚        â”‚
â”‚  â”‚      ]                                                â”‚        â”‚
â”‚  â”‚    }                                                  â”‚        â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜        â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                    â”‚
                    â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ ãƒ•ãƒ­ãƒ³ãƒˆã‚¨ãƒ³ãƒ‰                                                     â”‚
â”‚                                                                   â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”        â”‚
â”‚  â”‚ 5. æœŸé™ã‚’è¡¨ç¤º                                          â”‚        â”‚
â”‚  â”‚    "æå‡ºæœŸé™: 1æœˆ15æ—¥(æ°´) 23:59ã¾ã§"                   â”‚        â”‚
â”‚  â”‚                                                       â”‚        â”‚
â”‚  â”‚ 6. ç¾åœ¨æ—¥æ™‚ã¨æ¯”è¼ƒ                                      â”‚        â”‚
â”‚  â”‚    - æœŸé™å†… â†’ å…¥åŠ›ãƒ•ã‚©ãƒ¼ãƒ æœ‰åŠ¹                         â”‚        â”‚
â”‚  â”‚    - æœŸé™è¶…é â†’ å…¥åŠ›ãƒ•ã‚©ãƒ¼ãƒ ç„¡åŠ¹åŒ–                     â”‚        â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜        â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
</pre>
</div>

<h3>4.6 employment_type ã®ãƒãƒƒãƒ”ãƒ³ã‚°</h3>

<table>
    <tr>
        <th>hr.staff.employment_type<br>(ã‚¹ã‚¿ãƒƒãƒ•ãƒã‚¹ã‚¿ãƒ¼)</th>
        <th>core.employment_types.employment_code<br>(é›‡ç”¨å½¢æ…‹ãƒã‚¹ã‚¿ãƒ¼)</th>
        <th>core.shift_deadline_settings.employment_type<br>(æœŸé™è¨­å®š)</th>
        <th>èª¬æ˜</th>
    </tr>
    <tr>
        <td>æ­£ç¤¾å“¡ã‚’ç¤ºã™å€¤</td>
        <td>'FULL_TIME'</td>
        <td>'FULL_TIME'</td>
        <td>æ­£ç¤¾å“¡<br>ç· åˆ‡: N-1æœˆ10æ—¥23:59</td>
    </tr>
    <tr>
        <td>ã‚¢ãƒ«ãƒã‚¤ãƒˆãƒ»ãƒ‘ãƒ¼ãƒˆã‚’ç¤ºã™å€¤</td>
        <td>'PART_TIME'</td>
        <td>'PART_TIME'</td>
        <td>ã‚¢ãƒ«ãƒã‚¤ãƒˆãƒ»ãƒ‘ãƒ¼ãƒˆ<br>ç· åˆ‡: N-1æœˆ15æ—¥23:59</td>
    </tr>
</table>

<div class="info">
<strong>â„¹ï¸ è£œè¶³:</strong>
<ul>
    <li>LIFF (index.html) ã§ã¯ <code>selectedStaff.employment_type</code> ã‚’ç›´æ¥ä½¿ç”¨</li>
    <li>å€¤ã¯ <code>employmentTypesMap</code> ã‹ã‚‰å–å¾—ã—ãŸ <code>employment_code</code></li>
    <li>ãƒ‡ãƒ•ã‚©ãƒ«ãƒˆå€¤ã¯ <code>'PART_TIME'</code></li>
</ul>
</div>

<h2 id="test-results">5. ãƒ†ã‚¹ãƒˆçµæœ</h2>

<h3>5.1 ãƒ­ãƒ¼ã‚«ãƒ«PostgreSQLã§ã®ãƒ†ã‚¹ãƒˆ</h3>

<div class="success">
<strong>âœ… ãƒ†ã‚¹ãƒˆå®Ÿæ–½æ—¥:</strong> 2025-11-28<br>
<strong>âœ… ãƒ†ã‚¹ãƒˆç’°å¢ƒ:</strong> PostgreSQL 17.7 (ãƒ­ãƒ¼ã‚«ãƒ«)<br>
<strong>âœ… ãƒ†ã‚¹ãƒˆãƒ‡ãƒ¼ã‚¿ãƒ™ãƒ¼ã‚¹:</strong> shift_scheduler_test
</div>

<table>
    <tr>
        <th>ãƒ†ã‚¹ãƒˆé …ç›®</th>
        <th>çµæœ</th>
        <th>è©³ç´°</th>
    </tr>
    <tr>
        <td><strong>DDLå®Ÿè¡Œ</strong></td>
        <td><span class="success">âœ… æˆåŠŸ</span></td>
        <td>â€¢ ãƒ†ãƒ¼ãƒ–ãƒ«ä½œæˆæˆåŠŸ<br>â€¢ ãƒˆãƒªã‚¬ãƒ¼ä½œæˆæˆåŠŸ<br>â€¢ ã‚¤ãƒ³ãƒ‡ãƒƒã‚¯ã‚¹ä½œæˆæˆåŠŸ<br>â€¢ COMMENTè¿½åŠ æˆåŠŸ</td>
    </tr>
    <tr>
        <td><strong>DMLå®Ÿè¡Œ</strong></td>
        <td><span class="success">âœ… æˆåŠŸ</span></td>
        <td>â€¢ FULL_TIME: deadline_day=10<br>â€¢ PART_TIME: deadline_day=15<br>â€¢ ä¸¡ãƒ¬ã‚³ãƒ¼ãƒ‰æ­£å¸¸æŒ¿å…¥</td>
    </tr>
    <tr>
        <td><strong>CHECKåˆ¶ç´„ãƒ†ã‚¹ãƒˆ</strong></td>
        <td><span class="success">âœ… æˆåŠŸ</span></td>
        <td>â€¢ deadline_day=32 â†’ ã‚¨ãƒ©ãƒ¼<br>â€¢ deadline_hour=25 â†’ ã‚¨ãƒ©ãƒ¼<br>â€¢ deadline_minute=60 â†’ ã‚¨ãƒ©ãƒ¼</td>
    </tr>
    <tr>
        <td><strong>FKåˆ¶ç´„ãƒ†ã‚¹ãƒˆ</strong></td>
        <td><span class="success">âœ… æˆåŠŸ</span></td>
        <td>â€¢ tenant_id=9999 â†’ ã‚¨ãƒ©ãƒ¼<br>ï¼ˆå­˜åœ¨ã—ãªã„ãƒ†ãƒŠãƒ³ãƒˆï¼‰</td>
    </tr>
    <tr>
        <td><strong>UNIQUEåˆ¶ç´„ãƒ†ã‚¹ãƒˆ</strong></td>
        <td><span class="success">âœ… æˆåŠŸ</span></td>
        <td>â€¢ é‡è¤‡ãƒ¬ã‚³ãƒ¼ãƒ‰æŒ¿å…¥ â†’ ã‚¨ãƒ©ãƒ¼<br>(tenant_id=3, employment_type='FULL_TIME')</td>
    </tr>
</table>

<h3>5.2 ãƒ†ã‚¹ãƒˆã‚¯ã‚¨ãƒªçµæœ</h3>

<div class="code-block">
<pre>
-- ç™»éŒ²ãƒ‡ãƒ¼ã‚¿ç¢ºèª
SELECT
    deadline_setting_id,
    tenant_id,
    employment_type,
    deadline_day,
    deadline_hour,
    deadline_minute,
    is_enabled,
    description,
    created_at
FROM core.shift_deadline_settings
ORDER BY employment_type;

-- çµæœ:
 deadline_setting_id | tenant_id | employment_type | deadline_day | deadline_hour | deadline_minute | is_enabled | description
---------------------+-----------+-----------------+--------------+---------------+-----------------+------------+----------------------------------------------------------
                   1 |         3 | FULL_TIME       |           10 |            23 |              59 | t          | æ­£ç¤¾å“¡ã®ã‚·ãƒ•ãƒˆå¸Œæœ›ç· åˆ‡ï¼ˆç¬¬1æ¡ˆä½œæˆå®Œäº†ï½N-1æœˆ10æ—¥23:59ï¼‰
                   2 |         3 | PART_TIME       |           15 |            23 |              59 | t          | ã‚¢ãƒ«ãƒã‚¤ãƒˆãƒ»ãƒ‘ãƒ¼ãƒˆã®ã‚·ãƒ•ãƒˆå¸Œæœ›ç· åˆ‡ï¼ˆç¬¬1æ¡ˆä½œæˆå®Œäº†ï½N-1æœˆ15æ—¥23:59ï¼‰
(2 rows)
</pre>
</div>

<h3>5.3 ãƒ‡ãƒ—ãƒ­ã‚¤ãƒ¡ãƒ³ãƒˆè¨ˆç”»</h3>

<table>
    <tr>
        <th>ãƒ•ã‚§ãƒ¼ã‚º</th>
        <th>å†…å®¹</th>
        <th>å„ªå…ˆåº¦</th>
        <th>çŠ¶æ…‹</th>
    </tr>
    <tr>
        <td><strong>Phase 1</strong></td>
        <td>STGç’°å¢ƒã¸ã®ãƒ‡ãƒ—ãƒ­ã‚¤<br>â€¢ DDL/DMLå®Ÿè¡Œ<br>â€¢ Backend APIå‹•ä½œç¢ºèª<br>â€¢ LIFFå´ã‹ã‚‰ã®APIå‘¼ã³å‡ºã—ç¢ºèª</td>
        <td>ğŸ”´ é«˜</td>
        <td><span class="warning">âš ï¸ æœªå®Ÿæ–½</span></td>
    </tr>
    <tr>
        <td><strong>Phase 2</strong></td>
        <td>æœ¬ç•ªç’°å¢ƒã¸ã®ãƒ‡ãƒ—ãƒ­ã‚¤<br>â€¢ DDL/DMLå®Ÿè¡Œ<br>â€¢ æ—¢å­˜ãƒ‡ãƒ¼ã‚¿ã¸ã®å½±éŸ¿ãŒãªã„ã“ã¨ã‚’ç¢ºèª<br>â€¢ LIFFå´PR #13ã®ãƒãƒ¼ã‚¸ã¨ãƒ‡ãƒ—ãƒ­ã‚¤</td>
        <td>ğŸ”´ é«˜</td>
        <td><span class="warning">âš ï¸ æœªå®Ÿæ–½</span></td>
    </tr>
</table>

<div class="info">
<strong>ğŸ“Œ å°†æ¥çš„ãªæ‹¡å¼µãƒ•ã‚§ãƒ¼ã‚ºï¼ˆå„ªå…ˆåº¦ä½ï¼‰</strong>
<ul>
    <li><strong>Phase 3:</strong> ãƒã‚¹ã‚¿ãƒ¼ç®¡ç†APIå®Ÿè£…ï¼ˆ/api/master/shift-deadline-settingsï¼‰</li>
    <li><strong>Phase 4:</strong> ç®¡ç†ç”»é¢UIå®Ÿè£…ï¼ˆæœŸé™è¨­å®šã®CRUDç”»é¢ï¼‰</li>
    <li><strong>Phase 5:</strong> Reactç‰ˆãƒ•ãƒ­ãƒ³ãƒˆã‚¨ãƒ³ãƒ‰ã¸ã®å¯¾å¿œï¼ˆå¿…è¦ã«å¿œã˜ã¦ï¼‰</li>
</ul>
</div>

<h2>6. ã¾ã¨ã‚</h2>

<div class="success">
<h3>âœ… å®Œäº†ã—ãŸä½œæ¥­</h3>
<ul>
    <li>DDLè¨­è¨ˆå®Œäº†ï¼ˆpayment_type â†’ employment_typeã€start_dayå‰Šé™¤ã€CHECK/FK/UNIQUEåˆ¶ç´„è¿½åŠ ï¼‰</li>
    <li>DMLè¨­è¨ˆå®Œäº†ï¼ˆãƒ†ãƒŠãƒ³ãƒˆID 3 ã®åˆæœŸãƒ‡ãƒ¼ã‚¿å®šç¾©ï¼‰</li>
    <li>ãƒ­ãƒ¼ã‚«ãƒ«PostgreSQLã§ã®å…¨åˆ¶ç´„ãƒ†ã‚¹ãƒˆå®Œäº†ï¼ˆPostgreSQL 17.7ï¼‰</li>
    <li>Backend APIå®Ÿè£…å®Œäº†ï¼ˆGET /api/liff/deadline-settings ã‚¨ãƒ³ãƒ‰ãƒã‚¤ãƒ³ãƒˆè¿½åŠ ï¼‰</li>
    <li>LIFFå´ã®å¯¾å¿œå®Œäº†ï¼ˆPR #12: employment_typeåŸºæº–ã«å¤‰æ›´ã€PR #13: start_dayå‰Šé™¤ã¨ã‚¨ãƒ³ãƒ‰ãƒã‚¤ãƒ³ãƒˆä¿®æ­£ï¼‰</li>
    <li>å½±éŸ¿ç¯„å›²åˆ†æå®Œäº†ï¼ˆæ—¢å­˜ã‚·ã‚¹ãƒ†ãƒ ã¸ã®å½±éŸ¿ãªã—ç¢ºèªï¼‰</li>
    <li>è¨­è¨ˆæ›¸ä½œæˆå®Œäº†ï¼ˆv2.0.0ï¼‰</li>
</ul>
</div>

<div class="warning">
<h3>âš ï¸ ä»Šå¾Œã®ä½œæ¥­</h3>
<ul>
    <li><strong>STGç’°å¢ƒ:</strong> DDL/DMLå®Ÿè¡Œã¨ãƒ‡ãƒ¼ã‚¿ç¢ºèª</li>
    <li><strong>æœ¬ç•ªç’°å¢ƒ:</strong> ãƒã‚¤ã‚°ãƒ¬ãƒ¼ã‚·ãƒ§ãƒ³å®Ÿæ–½</li>
    <li><strong>LIFFå´:</strong> PR #13ã®ãƒãƒ¼ã‚¸</li>
</ul>
</div>

<div class="info">
<h3>ğŸ“ å°†æ¥çš„ãªæ‹¡å¼µï¼ˆå„ªå…ˆåº¦ä½ï¼‰</h3>
<ul>
    <li><strong>ãƒã‚¹ã‚¿ãƒ¼ç®¡ç†API:</strong> /api/master/shift-deadline-settings ã®å®Ÿè£…ï¼ˆç®¡ç†ç”»é¢ã‹ã‚‰ã®æœŸé™è¨­å®šå¤‰æ›´ç”¨ï¼‰</li>
    <li><strong>Reactç‰ˆãƒ•ãƒ­ãƒ³ãƒˆã‚¨ãƒ³ãƒ‰:</strong> Reactç‰ˆã‚’ä½¿ç”¨ã™ã‚‹å ´åˆã¯ã€LineShiftInput.jsxç­‰ã¸ã®å¯¾å¿œãŒå¿…è¦</li>
    <li><strong>BackendæœŸé™ãƒã‚§ãƒƒã‚¯:</strong> ã‚»ã‚­ãƒ¥ãƒªãƒ†ã‚£è¦ä»¶ãŒå¤‰æ›´ã•ã‚ŒãŸå ´åˆã€DeadlineValidationServiceã‚’å®Ÿè£…</li>
</ul>
</div>

<h2>7. é–¢é€£ãƒªã‚½ãƒ¼ã‚¹</h2>

<table>
    <tr>
        <th>ç¨®é¡</th>
        <th>ãƒ‘ã‚¹/URL</th>
    </tr>
    <tr>
        <td>DDL</td>
        <td>scripts/database/ddl/schema.sql</td>
    </tr>
    <tr>
        <td>DML</td>
        <td>scripts/database/dml/01_core_master.sql</td>
    </tr>
    <tr>
        <td>LIFF PR</td>
        <td>shift-scheduler-ai-liff #12 (MERGED), #13 (OPEN)</td>
    </tr>
    <tr>
        <td>Backend PR</td>
        <td><a href="https://github.com/The-botch/shift-scheduler-ai/pull/157" target="_blank">#157</a> (feature/shift-deadline-settings - OPEN)</td>
    </tr>
    <tr>
        <td>é–¢é€£Issue</td>
        <td>#155 ç· åˆ‡æ—¥è¨­å®šã®ä»•æ§˜æ•´ç†ã¨å®Ÿè£…</td>
    </tr>
</table>

<hr>

<p style="text-align: center; color: #7f8c8d; margin-top: 50px;">
    <strong>End of Document</strong><br>
    ã‚·ãƒ•ãƒˆå¸Œæœ›å…¥åŠ›æœŸé™è¨­å®šæ©Ÿèƒ½ - è¨­è¨ˆæ›¸ v2.0.0<br>
    Last Updated: 2025-11-28
</p>

</body>
</html>
