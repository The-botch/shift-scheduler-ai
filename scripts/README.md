# ã‚¹ã‚¯ãƒªãƒ—ãƒˆãƒ‡ã‚£ãƒ¬ã‚¯ãƒˆãƒªæ§‹æˆ

ã“ã®ãƒ‡ã‚£ãƒ¬ã‚¯ãƒˆãƒªã«ã¯ã€ãƒ‡ãƒ¼ã‚¿ãƒ™ãƒ¼ã‚¹ç®¡ç†ç”¨ã®å„ç¨®ã‚¹ã‚¯ãƒªãƒ—ãƒˆãŒæ ¼ç´ã•ã‚Œã¦ã„ã¾ã™ã€‚

## ğŸ“ ãƒ‡ã‚£ãƒ¬ã‚¯ãƒˆãƒªæ§‹æˆ

### scripts/setup/ - ãƒ‡ãƒ¼ã‚¿ãƒ™ãƒ¼ã‚¹ã‚»ãƒƒãƒˆã‚¢ãƒƒãƒ—ï¼ˆæœ€é‡è¦ï¼‰

å®Œå…¨ãªãƒ‡ãƒ¼ã‚¿ãƒ™ãƒ¼ã‚¹å†æ§‹ç¯‰ã«å¿…è¦ãªãƒ•ã‚¡ã‚¤ãƒ«ï¼š

- **schema.sql** (801è¡Œ) - DDL: ãƒ†ãƒ¼ãƒ–ãƒ«å®šç¾©
- **seed_data.sql** (265è¡Œ) - DML: ãƒã‚¹ã‚¿ãƒ¼ãƒ‡ãƒ¼ã‚¿å®Œå…¨ç‰ˆ
  - Tenant 1: DEMOï¼ˆãƒ‡ãƒ¢ä¼æ¥­ï¼‰
  - Tenant 3: STAND_BANH_MI
- **seed_transaction_data.sql** (7,676è¡Œ, 2.7MB) - DML: ãƒˆãƒ©ãƒ³ã‚¶ã‚¯ã‚·ãƒ§ãƒ³ãƒ‡ãƒ¼ã‚¿
  - 33ä»¶ã®ã‚·ãƒ•ãƒˆè¨ˆç”»
  - 5,885ä»¶ã®ã‚·ãƒ•ãƒˆå®Ÿç¸¾
  - 1,550ä»¶ã®å‹¤æ€ å®Ÿç¸¾
  - 90ä»¶ã®çµ¦ä¸ãƒ‡ãƒ¼ã‚¿
  - ãã®ä»–åˆ†æãƒ‡ãƒ¼ã‚¿

**ã‚»ãƒƒãƒˆã‚¢ãƒƒãƒ—ã‚¹ã‚¯ãƒªãƒ—ãƒˆï¼š**
- `import_all_17_masters.mjs` - CSVã‹ã‚‰å…¨ãƒã‚¹ã‚¿ãƒ¼ãƒ‡ãƒ¼ã‚¿ã‚’æŠ•å…¥
- `setup_fresh_db.mjs` - DBå®Œå…¨ãƒªã‚»ãƒƒãƒˆï¼†å†æ§‹ç¯‰
- `setup_tenant3_test_data.mjs` - Tenant 3ãƒ†ã‚¹ãƒˆãƒ‡ãƒ¼ã‚¿æŠ•å…¥
- `verify_setup.mjs` - ã‚»ãƒƒãƒˆã‚¢ãƒƒãƒ—æ¤œè¨¼

### scripts/ - ãƒ„ãƒ¼ãƒ«ãƒ»æ¤œè¨¼ã‚¹ã‚¯ãƒªãƒ—ãƒˆ

**ãƒã‚¹ã‚¿ãƒ¼ãƒ‡ãƒ¼ã‚¿ç¢ºèªï¼š**
- `check_master_data.mjs` - ã‚³ã‚¢ãƒã‚¹ã‚¿ãƒ¼ç¢ºèªï¼ˆtenants, stores, roles, etcï¼‰
- `check_all_masters.mjs` - HR/OPSãƒã‚¹ã‚¿ãƒ¼ç¢ºèªï¼ˆcommute, insurance, etcï¼‰
- `check_transactions.mjs` - ãƒˆãƒ©ãƒ³ã‚¶ã‚¯ã‚·ãƒ§ãƒ³ãƒ‡ãƒ¼ã‚¿ç¢ºèª
- `verify_seed_data.mjs` - seed_data.sqlæ¤œè¨¼

**ã‚¨ã‚¯ã‚¹ãƒãƒ¼ãƒˆï¼š**
- `export_transaction_data.mjs` - ç¾åœ¨ã®ãƒˆãƒ©ãƒ³ã‚¶ã‚¯ã‚·ãƒ§ãƒ³ãƒ‡ãƒ¼ã‚¿ã‚’SQLå½¢å¼ã§ã‚¨ã‚¯ã‚¹ãƒãƒ¼ãƒˆ

**ãã®ä»–ãƒ„ãƒ¼ãƒ«ï¼š**
- `check_current_status.mjs` - ãƒ‡ãƒ¼ã‚¿ãƒ™ãƒ¼ã‚¹çŠ¶æ…‹ç¢ºèª
- `verify_store_ids.mjs` - åº—èˆ—IDæ¤œè¨¼
- `check_validation_rules_pk.mjs` - æ¤œè¨¼ãƒ«ãƒ¼ãƒ«PKç¢ºèª
- `update_staff_status.mjs` - ã‚¹ã‚¿ãƒƒãƒ•ã‚¹ãƒ†ãƒ¼ã‚¿ã‚¹æ›´æ–°

### scripts/dev/ - é–‹ç™ºãƒ»ãƒ‡ãƒãƒƒã‚°ç”¨

ãƒ‡ãƒ¼ã‚¿ã‚¤ãƒ³ãƒãƒ¼ãƒˆã€å£²ä¸Šåˆ†æã€çµ¦ä¸ãƒã‚§ãƒƒã‚¯ãªã©ã®é–‹ç™ºç”¨ãƒ„ãƒ¼ãƒ«ï¼ˆ13å€‹ï¼‰

### scripts/legacy/ - ã‚¢ãƒ¼ã‚«ã‚¤ãƒ–

æ—§ç‰ˆã‚¹ã‚¯ãƒªãƒ—ãƒˆï¼ˆéæ¨å¥¨ï¼‰

### scripts/migrations/ - ãƒã‚¤ã‚°ãƒ¬ãƒ¼ã‚·ãƒ§ãƒ³

ãƒ‡ãƒ¼ã‚¿ãƒ™ãƒ¼ã‚¹ã‚¹ã‚­ãƒ¼ãƒå¤‰æ›´ç”¨ã‚¹ã‚¯ãƒªãƒ—ãƒˆ

## ğŸš€ ä½¿ç”¨æ–¹æ³•

### å®Œå…¨ãªåˆæœŸã‚»ãƒƒãƒˆã‚¢ãƒƒãƒ—

```bash
# æ–¹æ³•1: SQLãƒ•ã‚¡ã‚¤ãƒ«ç›´æ¥å®Ÿè¡Œï¼ˆæ¨å¥¨ï¼‰
psql $DATABASE_URL -f scripts/setup/schema.sql
psql $DATABASE_URL -f scripts/setup/seed_data.sql
psql $DATABASE_URL -f scripts/setup/seed_transaction_data.sql

# æ–¹æ³•2: è‡ªå‹•ã‚»ãƒƒãƒˆã‚¢ãƒƒãƒ—ã‚¹ã‚¯ãƒªãƒ—ãƒˆ
node scripts/setup/setup_fresh_db.mjs

# æ–¹æ³•3: CSVã‹ã‚‰ãƒã‚¹ã‚¿ãƒ¼ãƒ‡ãƒ¼ã‚¿æŠ•å…¥
psql $DATABASE_URL -f scripts/setup/schema.sql
node scripts/setup/import_all_17_masters.mjs
psql $DATABASE_URL -f scripts/setup/seed_transaction_data.sql
```

### ã‚»ãƒƒãƒˆã‚¢ãƒƒãƒ—æ¤œè¨¼

```bash
# ãƒã‚¹ã‚¿ãƒ¼ãƒ‡ãƒ¼ã‚¿æ¤œè¨¼
node scripts/verify_seed_data.mjs

# ãƒˆãƒ©ãƒ³ã‚¶ã‚¯ã‚·ãƒ§ãƒ³ãƒ‡ãƒ¼ã‚¿ç¢ºèª
node scripts/check_transactions.mjs

# ã‚»ãƒƒãƒˆã‚¢ãƒƒãƒ—å…¨ä½“æ¤œè¨¼
node scripts/setup/verify_setup.mjs
```

### ãƒ‡ãƒ¼ã‚¿ã‚¨ã‚¯ã‚¹ãƒãƒ¼ãƒˆ

```bash
# ãƒˆãƒ©ãƒ³ã‚¶ã‚¯ã‚·ãƒ§ãƒ³ãƒ‡ãƒ¼ã‚¿ã‚’SQLã§ã‚¨ã‚¯ã‚¹ãƒãƒ¼ãƒˆ
node scripts/export_transaction_data.mjs

# å‡ºåŠ›å…ˆ: scripts/setup/seed_transaction_data.sql
```

## ğŸ“ ãƒ•ã‚¡ã‚¤ãƒ«æ›´æ–°å±¥æ­´

- **2025-11-06**: 
  - seed_data.sqlã‚’ãƒ†ãƒŠãƒ³ãƒˆåˆ¥ã«ã‚³ãƒ¡ãƒ³ãƒˆæ•´ç†
  - seed_transaction_data.sqlã‚’ç¾åœ¨ã®DBã‹ã‚‰å†ç”Ÿæˆï¼ˆ1.3MBâ†’2.7MBï¼‰
  - ä¸è¦ãªä¿®æ­£ç³»ã‚¹ã‚¯ãƒªãƒ—ãƒˆ24å€‹ã‚’å‰Šé™¤
  - æ¤œè¨¼ãƒ»ã‚¨ã‚¯ã‚¹ãƒãƒ¼ãƒˆã‚¹ã‚¯ãƒªãƒ—ãƒˆã‚’è¿½åŠ 

## ğŸ—‘ï¸ å‰Šé™¤ã•ã‚ŒãŸã‚¹ã‚¯ãƒªãƒ—ãƒˆ

ä»¥ä¸‹ã®ã‚¹ã‚¯ãƒªãƒ—ãƒˆã¯éå»ã®ä¸€æ™‚çš„ãªå•é¡Œè§£æ±ºç”¨ã§ã€ç¾åœ¨ã¯ä¸è¦ã®ãŸã‚å‰Šé™¤ã•ã‚Œã¾ã—ãŸï¼š

- ã‚¹ã‚¿ãƒƒãƒ•é‡è¤‡è§£æ¶ˆç³»ï¼ˆdeduplicate, analyze, etcï¼‰
- Tenant 3ãƒ‡ãƒ¼ã‚¿ã‚³ãƒ”ãƒ¼ç³»ï¼ˆcopy_*_to_tenant3ï¼‰
- å€‹åˆ¥ä¿®æ­£ç³»ï¼ˆfix_hashimoto, check_kitamura, etcï¼‰
- ãƒã‚¹ã‚¿ãƒ¼ãƒ‡ãƒ¼ã‚¿è¿½åŠ ç³»ï¼ˆupdate_role_names, add_employment_typesï¼‰

ã“ã‚Œã‚‰ã®æ©Ÿèƒ½ã¯ç¾åœ¨ã® seed_data.sql ã¨ seed_transaction_data.sql ã«çµ±åˆã•ã‚Œã¦ã„ã¾ã™ã€‚

## âš ï¸ æ³¨æ„äº‹é …

- **æœ¬ç•ªç’°å¢ƒã§ã®å®Ÿè¡Œå‰ã«å¿…ãšãƒãƒƒã‚¯ã‚¢ãƒƒãƒ—ã‚’å–ã£ã¦ãã ã•ã„**
- seed_transaction_data.sqlã¯ã‚µã‚¤ã‚ºãŒå¤§ãã„ãŸã‚ã€å®Ÿè¡Œã«æ•°åˆ†ã‹ã‹ã‚‹å ´åˆãŒã‚ã‚Šã¾ã™
- setup_fresh_db.mjsã¯æ—¢å­˜ãƒ‡ãƒ¼ã‚¿ã‚’ã™ã¹ã¦å‰Šé™¤ã™ã‚‹ãŸã‚ã€é–‹ç™ºç’°å¢ƒä»¥å¤–ã§ã¯ä½¿ç”¨ã—ãªã„ã§ãã ã•ã„
